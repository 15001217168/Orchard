@model Orchard.Localization.ViewModels.EditLocalizationViewModel
@using System.Linq;
@{
    Style.Require("LocalizationAdmin");
    var siteCultures = Model.SiteCultures.ToList();
}
<fieldset class="localization culture-selection">
    @if (Model.ContentItem.ContentItem.Id == 0 && Model.SelectedCulture == null && Model.ContentLocalizations.Localizations.Count() == 0) {
        /* If this is a new item */
        <fieldset class="localization culture-selection">
            <label for="SelectedCulture">@T("Content Localization")</label>
            <div>
                @T("This is the <em>{0}</em> variation of the content",
                        Html.DropDownList("SelectedCulture", new SelectList(siteCultures, Model.SelectedCulture)))
            </div>
        </fieldset>
    }
    
    @if (Model.ContentItem.ContentItem.Id > 0 && Model.SelectedCulture != null && Model.ContentLocalizations.Localizations.Count() > 0) {
        <fieldset class="culture-selected">
            <label for="SelectedCulture">@T("Content Localization")</label>
            <div>
                @T("This is the <em>{0}</em> variation of {1}.",
                    Html.Encode(Model.SelectedCulture),
                    Html.ItemEditLink(Model.MasterContentItem ?? Model.ContentItem))
            </div>
            @Html.Hidden("SelectedCulture", Model.SelectedCulture)
        </fieldset>
        if (Model.ContentLocalizations.Localizations.Count() > 0) {
            <dl class="content-localization">
                <dt>@T("Other translations:")</dt>
                <dd class="content-localizations">
                    @Html.UnorderedList(Model.ContentLocalizations.Localizations, (c, i) => Html.ItemEditLink(c.Culture.Culture, c), "localizations")
                </dd>
            </dl>
        }
    }

    @if (Model.SelectedCulture != null && !siteCultures.All(c => c == Model.SelectedCulture || Model.ContentLocalizations.Localizations.Any(l => c == l.Culture.Culture))) {
        <div class="add-localization">@Html.ActionLink(T("+ New translation").Text, "Translate", "Admin", new { area = "Orchard.Localization", id = Model.ContentItem.Id }, null)</div>
    }
</fieldset>
