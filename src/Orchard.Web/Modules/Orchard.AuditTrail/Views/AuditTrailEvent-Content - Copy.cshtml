@using Orchard.AuditTrail.Models
@using Orchard.AuditTrail.Providers.Content
@using Orchard.ContentManagement
@{
    var record = (AuditTrailEventRecord)Model.Record;
    var contentItem = (ContentItem) Model.ContentItem;
    var previousVersion = (ContentItem) Model.PreviousVersion;
    var diffNodes = (IEnumerable<DiffNode>) Model.DiffNodes;
}

<fieldset>
    <strong>@Html.ItemDisplayText(contentItem)</strong>@T(" - ")@contentItem.ContentType
    <span class="hint">@T("Version {0}", contentItem.Version)</span>
    @if (!String.IsNullOrWhiteSpace(record.Comment)) {
        <text>&quot;@record.Comment&quot;</text>
    }
</fieldset>
@if (previousVersion != null) {
    <table class="items">
        <thead>
            <tr>
                <th>@T("Diff Type")</th>
                <th>@T("Context")</th>
                <th>@T("Before")</th>
                <th>@T("After")</th>
            </tr>
        </thead>
        <tbody>
            @if (!diffNodes.Any()) {
                <tr>
                    <td colspan="4">@T("")</td>
                </tr>
            }
            else {
                foreach (var node in diffNodes) {
                    <tr>
                        <td>@T(node.Type.ToString())</td>
                        <td>@node.Context</td>
                        <td>@node.Previous</td>
                        <td>@node.Current</td>
                    </tr>
                }
            }
        </tbody>
    </table>
    
}